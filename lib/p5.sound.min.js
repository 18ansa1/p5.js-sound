/*! p5.sound.min.js v0.1 2014-08-05 */

var sndcore;sndcore=function(){"use strict";window.AudioContext=window.AudioContext||window.webkitAudioContext;var t=new window.AudioContext;p5.prototype.getAudioContext=function(){return t},"function"!=typeof t.createGain&&(window.audioContext.createGain=window.audioContext.createGainNode),"function"!=typeof t.createDelay&&(window.audioContext.createDelay=window.audioContext.createDelayNode),"function"!=typeof window.AudioBufferSourceNode.prototype.start&&(window.AudioBufferSourceNode.prototype.start=window.AudioBufferSourceNode.prototype.noteGrainOn),"function"!=typeof window.AudioBufferSourceNode.prototype.stop&&(window.AudioBufferSourceNode.prototype.stop=window.AudioBufferSourceNode.prototype.noteOff),"function"!=typeof window.OscillatorNode.prototype.start&&(window.OscillatorNode.prototype.start=window.OscillatorNode.prototype.noteOn),"function"!=typeof window.OscillatorNode.prototype.stop&&(window.OscillatorNode.prototype.stop=window.OscillatorNode.prototype.noteOff),window.AudioContext.prototype.hasOwnProperty("createScriptProcessor")||(window.AudioContext.prototype.createScriptProcessor=window.AudioContext.prototype.createJavaScriptNode),navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;var e=document.createElement("audio");p5.prototype.isSupported=function(){return!!e.canPlayType};var o=function(){return!!e.canPlayType&&e.canPlayType('audio/ogg; codecs="vorbis"')},i=function(){return!!e.canPlayType&&e.canPlayType("audio/mpeg;")},n=function(){return!!e.canPlayType&&e.canPlayType('audio/wav; codecs="1"')},s=function(){return!!e.canPlayType&&(e.canPlayType("audio/x-m4a;")||e.canPlayType("audio/aac;"))},r=function(){return!!e.canPlayType&&e.canPlayType("audio/x-aiff;")};p5.prototype.isFileSupported=function(t){switch(t.toLowerCase()){case"mp3":return i();case"wav":return n();case"ogg":return o();case"mp4":return s();case"aiff":return r();default:return!1}}}();var master;master=function(){"use strict";var t=function(){var t=p5.prototype.getAudioContext();this.input=t.createGain(),this.output=t.createGain(),this.limiter=t.createDynamicsCompressor(),this.limiter.threshold.value=0,this.limiter.ratio.value=100,this.audiocontext=t,this.output.disconnect(this.audiocontext.destination),this.inputSources=[],this.input.connect(this.limiter),this.limiter.connect(this.output),this.meter=t.createGain(),this.output.connect(this.meter),this.output.connect(this.audiocontext.destination),this.soundArray=[],this.extensions=[]},e=new t;return e}(sndcore);var helpers;helpers=function(){"use strict";var t=master;p5.prototype.masterVolume=function(e){t.output.gain.value=e},p5.prototype.sampleRate=function(){return t.audiocontext.sampleRate},p5.prototype.getMasterVolume=function(){return t.output.gain.value},p5.prototype.freqToMidi=function(t){var e=Math.log(t/440)/Math.log(2),o=Math.round(12*e)+57;return o},p5.prototype.midiToFreq=function(t){return 440*Math.pow(2,(t-69)/12)},p5.prototype.soundFormats=function(){t.extensions=[];for(var e=0;e<arguments.length;e++){if(arguments[e]=arguments[e].toLowerCase(),!(["mp3","wav","ogg","m4a","aac"].indexOf(arguments[e])>-1))throw arguments[e]+" is not a valid sound format!";t.extensions.push(arguments[e])}},p5.prototype._registerRemoveFunc("disposeSound"),p5.prototype.disposeSound=function(){for(var e=0;e<t.soundArray.length;e++)console.log(t.soundArray[e]),t.soundArray[e].dispose(),console.log(t.soundArray[e])}}(master);var soundfile;soundfile=function(){"use strict";var t=master;p5.prototype.SoundFile=function(e,o){var i;if("string"==typeof e){i=e;var n=i.split(".").pop();if(["mp3","wav","ogg","m4a","aac"].indexOf(n)>-1){var s=p5.prototype.isFileSupported(n);if(s)i=i;else for(var r=i.split("."),a=r[r.length-2],p=0;p<t.extensions.length;p++){var u=t.extensions[p],s=p5.prototype.isFileSupported(u);if(s){a="";for(var p=0;p<=r.length-2;p++)a.push(r[p]);i=a+"."+u,console.log(i);break}}}else for(var p=0;p<t.extensions.length;p++){var u=t.extensions[p],s=p5.prototype.isFileSupported(u);if(s){i=i+"."+u;break}}}else if("object"==typeof e)for(var p=0;p<e.length;p++){var u=e[p].split(".").pop(),s=p5.prototype.isFileSupported(u);if(s){console.log("."+u+" is "+s+" supported by your browser."),i=e[p];break}}this.url=i,this.sources=[],this.source=null,this.buffer=null,this.playbackRate=1,this.gain=1,this.input=t.audiocontext.createGain(),this.output=t.audiocontext.createGain(),this.reversed=!1,this.startTime=0,this.endTime=null,this.playing=!1,this.paused=null,this.mode="sustain",this.startMillis=null,this.amplitude=new p5.prototype.Amplitude,this.output.connect(this.amplitude.input),this.panPosition=0,this.panner=t.audiocontext.createPanner(),this.panner.panningModel="equalpower",this.panner.distanceModel="linear",this.panner.setPosition(0,0,0),this.output.connect(this.panner),this.panner.connect(t.input),this.load(o),t.soundArray.push(this)},p5.prototype._registerPreloadFunc("loadSound"),p5.prototype.loadSound=function(t,e){window.location.origin.indexOf("file://")>-1&&alert("This sketch may require a server to load external files. Please see http://bit.ly/1qcInwS");var o=new p5.prototype.SoundFile(t,e);return o},p5.prototype.SoundFile.prototype.load=function(t){if(this.buffer)t&&t(this);else{var e=new XMLHttpRequest;e.open("GET",this.url,!0),e.responseType="arraybuffer";var o=this;e.onload=function(){var i=p5.prototype.getAudioContext();i.decodeAudioData(e.response,function(e){o.buffer=e,t&&t(o)})},e.send()}},p5.prototype.SoundFile.prototype.isLoaded=function(){return this.buffer?!0:!1},p5.prototype.SoundFile.prototype.play=function(e,o,i,n){var s=t.audiocontext.currentTime;if(!this.buffer)throw"not ready to play file, buffer has yet to load. Try preload()";if("restart"===this.mode&&this.buffer&&this.source&&this.source.stop(),i){if(!(i>=0&&i<this.buffer.duration))throw"start time out of range";this.startTime=i}if(n){if(!(n>=0&&n<=this.buffer.duration))throw"end time out of range";this.endTime=n}else this.endTime=this.buffer.duration;this.source=t.audiocontext.createBufferSource(),this.source.buffer=this.buffer,this.source.loop=this.looping,this.source.loop===!0&&(this.source.loopStart=this.startTime,this.source.loopEnd=this.endTime),this.source.onended=function(){this.playing&&(this.playing=!this.playing,this.stop())},this.source.gain?(this.source.gain.value=o||1,this.source.connect(this.output)):(this.source.gain=t.audiocontext.createGain(),this.source.connect(this.source.gain),this.source.gain.gain.value=o||1,this.source.gain.connect(this.output)),this.source.playbackRate.cancelScheduledValues(s),e=e||Math.abs(this.playbackRate),this.source.playbackRate.setValueAtTime(e,s),this.paused&&(this.wasUnpaused=!0),this.paused&&this.wasUnpaused?this.source.start(0,this.pauseTime,this.endTime):(this.wasUnpaused=!1,this.pauseTime=0,this.source.start(0,this.startTime,this.endTime)),this.startSeconds=s,this.playing=!0,this.paused=!1,this.sources.push(this.source)},p5.prototype.SoundFile.prototype.playMode=function(t){var e=t.toLowerCase();if("restart"===e&&this.buffer&&this.source)for(var o=0;o<this.sources.length-1;o++)this.sources[o].stop();if("restart"!==e&&"sustain"!==e)throw'Invalid play mode. Must be either "restart" or "sustain"';this.mode=e},p5.prototype.SoundFile.prototype.pause=function(){this.looping;this.isPlaying()&&this.buffer&&this.source&&(this.pauseTime=this.currentTime(),this.source.stop(),this.paused=!0,this.wasUnpaused=!1,this.playing=!1)},p5.prototype.SoundFile.prototype.loop=function(t,e,o,i){this.looping=!0,this.play(t,e,o,i)},p5.prototype.SoundFile.prototype.setLoop=function(t){if(t===!0)this.looping=!0;else{if(t!==!1)throw"Error: setLoop accepts either true or false";this.looping=!1}this.source&&(this.source.loop=this.looping)},p5.prototype.SoundFile.prototype.isLooping=function(){return this.source&&this.looping===!0&&this.isPlaying()===!0?!0:!1},p5.prototype.SoundFile.prototype.isPlaying=function(){return this.playing},p5.prototype.SoundFile.prototype.isPaused=function(){return this.paused?this.paused:!1},p5.prototype.SoundFile.prototype.stop=function(){"sustain"==this.mode?(this.stopAll(),this.playing=!1,this.pauseTime=0,this.wasUnpaused=!1,this.paused=!1):this.buffer&&this.source&&(this.source.stop(),this.playing=!1,this.pauseTime=0,this.wasUnpaused=!1,this.paused=!1)},p5.prototype.SoundFile.prototype.stopAll=function(){if(this.buffer&&this.source)for(var t=0;t<this.sources.length;t++)null!==this.sources[t]&&this.sources[t].stop()},p5.prototype.SoundFile.prototype.setVolume=function(e,o,i){var o=o||0,i=i||0,n=t.audiocontext.currentTime,s=this.output.gain.value;this.output.gain.cancelScheduledValues(n),this.output.gain.setValueAtTime(s,n+i),this.output.gain.linearRampToValueAtTime(e,n+i+o)},p5.prototype.SoundFile.prototype.amp=p5.prototype.SoundFile.prototype.setVolume,p5.prototype.SoundFile.prototype.fade=p5.prototype.SoundFile.prototype.setVolume,p5.prototype.SoundFile.prototype.pan=function(t){this.panPosition=t,t=90*t;var e=parseInt(t),o=e+90;o>90&&(o=180-o);var i=Math.sin(e*(Math.PI/180)),n=Math.sin(o*(Math.PI/180));this.panner.setPosition(i,0,n)},p5.prototype.SoundFile.prototype.getPan=function(){return this.panPosition},p5.prototype.SoundFile.prototype.rate=function(e){if(this.playbackRate!==e||this.source.playbackRate.value!==e){this.playbackRate=e;var o=e;if(0===this.playbackRate&&this.playing&&this.pause(),this.playbackRate<0&&!this.reversed){{var i=this.currentTime();this.source.playbackRate.value}this.pause(),this.reverseBuffer(),o=Math.abs(e);var n=(i-this.duration())/o;this.pauseTime=n,this.play()}else this.playbackRate>0&&this.reversed&&this.reverseBuffer();if(this.source){var s=t.audiocontext.currentTime;this.source.playbackRate.cancelScheduledValues(s),this.source.playbackRate.linearRampToValueAtTime(Math.abs(o),s)}}},p5.prototype.SoundFile.prototype.getPlaybackRate=function(){return this.playbackRate},p5.prototype.SoundFile.prototype.duration=function(){return this.buffer?this.buffer.duration:0},p5.prototype.SoundFile.prototype.currentTime=function(){var e;if(this.isPlaying()){var o=t.audiocontext.currentTime-this.startSeconds+this.startTime+this.pauseTime;return e=o*this.playbackRate%(this.duration()*this.playbackRate)}return this.paused?this.pauseTime:this.startTime},p5.prototype.SoundFile.prototype.jump=function(t,e){if(0>t||t>this.buffer.duration)throw"jump time out of range";if(t>e||e>this.buffer.duration)throw"end time out of range";this.startTime=t||0,this.endTime=e?e:this.buffer.duration,this.isPlaying()&&(this.stop(),this.play(t,this.endTime))},p5.prototype.SoundFile.prototype.channels=function(){return this.buffer.numberOfChannels},p5.prototype.SoundFile.prototype.sampleRate=function(){return this.buffer.sampleRate},p5.prototype.SoundFile.prototype.frames=function(){return this.buffer.length},p5.prototype.SoundFile.prototype.getPeaks=function(t){if(!this.buffer)throw"Cannot load peaks yet, buffer is not loaded";if(t||(t=5*window.width),this.buffer){for(var e=this.buffer,o=e.length/t,i=~~(o/10)||1,n=e.numberOfChannels,s=new Float32Array(t),r=0;n>r;r++)for(var a=e.getChannelData(r),p=0;t>p;p++){for(var u=~~(p*o),c=~~(u+o),l=0,h=u;c>h;h+=i){var d=a[h];d>l?l=d:-d>l&&(l=d)}(0===r||l>s[p])&&(s[p]=l)}return s}},p5.prototype.SoundFile.prototype.reverseBuffer=function(){if(!this.buffer)throw"SoundFile is not done loading";Array.prototype.reverse.call(this.buffer.getChannelData(0)),Array.prototype.reverse.call(this.buffer.getChannelData(1)),this.reversed=!this.reversed},p5.prototype.SoundFile.prototype._onEnded=function(t){t.onended=function(t){t.stop()}},p5.prototype.SoundFile.prototype.add=function(){},p5.prototype.SoundFile.prototype.dispose=function(){if(this.buffer&&this.source)for(var t=0;t<this.sources.length-1;t++)null!==this.sources[t]&&(this.sources[t].stop(),this.sources[t]=null);null!==this.output&&(this.output.disconnect(),this.output=null),null!==this.panner&&(this.panner.disconnect(),this.panner=null)},p5.prototype.SoundFile.prototype.connect=function(e){e?this.buffer&&this.source&&this.panner.connect(e.hasOwnProperty("input")?e.input:e):this.panner.connect(t.input)},p5.prototype.SoundFile.prototype.disconnect=function(t){this.panner.disconnect(t)},p5.prototype.SoundFile.prototype.getLevel=function(t){return t&&(this.amplitude.smoothing=t),this.amplitude.getLevel()}}(sndcore,master);var amplitude;amplitude=function(){"use strict";var t=master;p5.prototype.Amplitude=function(e){this.bufferSize=2048,this.audiocontext=t.audiocontext,this.processor=this.audiocontext.createScriptProcessor(this.bufferSize),this.input=this.processor,this.output=this.audiocontext.createGain(),this.smoothing=e||0,this.volume=0,this.average=0,this.volMax=.001,this.normalize=!1,this.processor.onaudioprocess=this.volumeAudioProcess.bind(this),this.processor.connect(this.output),this.output.gain.value=0,this.output.connect(this.audiocontext.destination),t.meter.connect(this.processor)},p5.prototype.Amplitude.prototype.setInput=function(e,o){t.meter.disconnect(this.processor),o&&(this.smoothing=o),null==e?(console.log("Amplitude input source is not ready! Connecting to master output instead"),t.meter.connect(this.processor)):e?(e.connect(this.processor),this.processor.disconnect(),this.processor.connect(this.output),console.log("source connected")):t.meter.connect(this.processor)},p5.prototype.Amplitude.prototype.connect=function(e){this.output.connect(e?e.hasOwnProperty("input")?e.input:e:this.panner.connect(t.input))},p5.prototype.Amplitude.prototype.disconnect=function(){this.output.disconnect()},p5.prototype.Amplitude.prototype.volumeAudioProcess=function(t){for(var e,o=t.inputBuffer.getChannelData(0),i=o.length,n=0,s=0,r=0;i>r;r++)e=o[r],this.normalize?(n+=p5.prototype.constrain(e/this.volMax,-1,1),s+=p5.prototype.constrain(e/this.volMax,-1,1)*p5.prototype.constrain(e/this.volMax,-1,1)):(n+=e,s+=e*e);var a=Math.sqrt(s/i);this.volume=Math.max(a,this.volume*this.smoothing),this.volMax=Math.max(this.volume,this.volMax),this.volNorm=p5.prototype.constrain(this.volume/this.volMax,0,1)},p5.prototype.Amplitude.prototype.getLevel=function(){return this.normalize?this.volNorm:this.volume},p5.prototype.Amplitude.prototype.toggleNormalize=function(t){this.normalize="boolean"==typeof t?t:!this.normalize},p5.prototype.Amplitude.prototype.smooth=function(t){t>=0&&1>t?this.smoothing=t:console.log("Error: smoothing must be between 0 and 1")}}(master);var fft;fft=function(){"use strict";var t=master;p5.prototype.FFT=function(e,o){var i=e||.8;0===e&&(i=e);var n=2*o||2048;this.analyser=t.audiocontext.createAnalyser(),t.output.connect(this.analyser),this.analyser.smoothingTimeConstant=i,this.analyser.fftSize=n,this.freqDomain=new Uint8Array(this.analyser.frequencyBinCount),this.timeDomain=new Uint8Array(this.analyser.frequencyBinCount)},p5.prototype.FFT.prototype.setInput=function(t,e){e&&(this.analyser.fftSize=2*e),t.output?t.output.connect(this.analyser):t.connect(this.analyser)},p5.prototype.FFT.prototype.waveform=function(){return this.analyser.getByteTimeDomainData(this.timeDomain),this.timeDomain},p5.prototype.FFT.prototype.analyze=function(t){return t&&(this.analyser.fftSize=2*t),this.analyser.getByteFrequencyData(this.freqDomain),this.freqDomain},p5.prototype.FFT.prototype.getFreq=function(e,o){var i=t.audiocontext.sampleRate/2;if("number"!=typeof e)return null;if(o){if(e&&o){if(e>o){var n=o;o=e,e=n}for(var s=Math.round(e/i*this.freqDomain.length),r=Math.round(o/i*this.freqDomain.length),a=0,p=0,u=s;r>=u;u++)a+=this.freqDomain[u],p+=1;var c=a/p;return c}throw"invalid input for getFreq()"}var l=Math.round(e/i*this.freqDomain.length);return this.freqDomain[l]},p5.prototype.FFT.prototype.smooth=function(t){this.analyser.smoothingTimeConstant=t}}(master);var oscillator;oscillator=function(){"use strict";var t=master;p5.prototype.Oscillator=function(e,o){this.started=!1,t=t,this.oscillator=t.audiocontext.createOscillator(),this.f=e||440,this.oscillator.frequency.value=this.f,this.oscillator.type=o||"sine";this.oscillator;this.input=t.audiocontext.createGain(),this.output=t.audiocontext.createGain(),this.ampNode=this.output.gain,this.freqNode=this.oscillator.frequency,this.output.gain.value=.5,this.panPosition=0,this.panner=t.audiocontext.createPanner(),this.panner.panningModel="equalpower",this.panner.distanceModel="linear",this.panner.setPosition(0,0,0),this.oscillator.connect(this.output),this.output.connect(this.panner),this.panner.connect(t.input),this.connection=t.input,t.soundArray.push(this)},p5.prototype.Oscillator.prototype.start=function(e,o){if(this.started&&this.stop(),!this.started){var i=e||this.f,n=this.oscillator.type;this.oscillator=t.audiocontext.createOscillator(),this.oscillator.frequency.exponentialRampToValueAtTime(Math.abs(i),t.audiocontext.currentTime),this.oscillator.type=n,this.oscillator.connect(this.output),this.started=!0,o=o||0,this.oscillator.start(o+t.audiocontext.currentTime),this.freqNode=this.oscillator.frequency,void 0!==this.mods&&void 0!==this.mods.frequency&&this.mods.frequency.connect(this.freqNode)}},p5.prototype.Oscillator.prototype.stop=function(e){if(this.started){var o=e||0,i=t.audiocontext.currentTime;this.oscillator.stop(o+i),this.started=!1}},p5.prototype.Oscillator.prototype.amp=function(e,o,i){if("number"==typeof e){var o=o||0,i=i||0,n=t.audiocontext.currentTime,s=this.output.gain.value;this.output.gain.cancelScheduledValues(n),this.output.gain.linearRampToValueAtTime(s,n+i+.001),this.output.gain.linearRampToValueAtTime(e,n+i+o+.001),this.ampMod&&(this.ampMod.output.disconnect(),this.ampMod=null)}else e.output&&(e.output.disconnect(),e.output.connect(this.output.gain),this.ampMod=e)},p5.prototype.Oscillator.prototype.fade=p5.prototype.Oscillator.prototype.amp,p5.prototype.Oscillator.prototype.getAmp=function(){return this.output.gain.value},p5.prototype.Oscillator.prototype.freq=function(e,o,i){if("number"==typeof e){this.f=e;var n=t.audiocontext.currentTime,o=o||0,i=i||0,s=this.oscillator.frequency.value;this.oscillator.frequency.cancelScheduledValues(n),this.oscillator.frequency.setValueAtTime(s,n+i),this.oscillator.frequency.exponentialRampToValueAtTime(e,i+o+n),this.freqMod&&(this.freqMod.output.disconnect(),this.freqMod=null)}else e.output&&(e.output.disconnect(),e.output.connect(this.oscillator.frequency),this.freqMod=e)},p5.prototype.Oscillator.prototype.getFreq=function(){return this.oscillator.frequency.value},p5.prototype.Oscillator.prototype.setType=function(t){this.oscillator.type=t},p5.prototype.Oscillator.prototype.getType=function(){return this.oscillator.type},p5.prototype.Oscillator.prototype.connect=function(e){e?e.hasOwnProperty("input")?(this.panner.connect(e.input),this.connection=e.input):(this.panner.connect(e),this.connection=e):this.panner.connect(t.input)},p5.prototype.Oscillator.prototype.disconnect=function(t){this.panner.disconnect(t)},p5.prototype.Oscillator.prototype.pan=function(t){t||(t=0),this.panPosition=t,t=90*t;var e=parseInt(t),o=e+90;o>90&&(o=180-o);var i=Math.sin(e*(Math.PI/180)),n=Math.sin(o*(Math.PI/180));this.panner.setPosition(i,0,n)},p5.prototype.Oscillator.prototype.getPan=function(){return this.panPosition},p5.prototype.Oscillator.prototype.dispose=function(){this.oscillator&&(this.stop(),this.disconnect(),this.oscillator.disconnect(),this.panner=null,this.oscillator=null),this.osc2&&this.osc2.dispose()},p5.prototype.Oscillator.prototype.mod=function(e){e.cancelScheduledValues(t.audiocontext.currentTime),this.output.connect(e)},p5.prototype.Oscillator.prototype.phase=function(e){this.dNode||(this.dNode=t.audiocontext.createDelay(),this.output.disconnect(),this.output.connect(this.dNode),this.dNode.connect(this.panner));var o=t.audiocontext.currentTime;this.dNode.delayTime.linearRampToValueAtTime(map(e,0,1,0,1/this.oscillator.frequency.value),o)},p5.prototype.SinOsc=function(t){p5.prototype.Oscillator.call(this,t,"sine")},p5.prototype.SinOsc.prototype=Object.create(p5.prototype.Oscillator.prototype),p5.prototype.TriOsc=function(t){p5.prototype.Oscillator.call(this,t,"triangle")},p5.prototype.TriOsc.prototype=Object.create(p5.prototype.Oscillator.prototype),p5.prototype.SawOsc=function(t){p5.prototype.Oscillator.call(this,t,"sawtooth")},p5.prototype.SawOsc.prototype=Object.create(p5.prototype.Oscillator.prototype),p5.prototype.SqrOsc=function(t){p5.prototype.Oscillator.call(this,t,"square")},p5.prototype.SqrOsc.prototype=Object.create(p5.prototype.Oscillator.prototype)}(master);var pulse;pulse=function(){"use strict";var t=master;p5.prototype.Pulse=function(e,o){p5.prototype.Oscillator.call(this,e,"sawtooth"),this.w=o||0,this.osc2=new SawOsc(e),this.dNode=t.audiocontext.createDelay(),this.dNode.delayTime.value=map(this.w,0,1,0,1/this.oscillator.frequency.value),this.osc2.disconnect(),this.osc2.panner.connect(this.dNode),this.dNode.connect(this.output)},p5.prototype.Pulse.prototype=Object.create(p5.prototype.Oscillator.prototype),p5.prototype.Pulse.prototype.width=function(t){1>=t&&t>=0&&(this.w=t,this.dNode.delayTime.value=map(this.w,0,1,0,1/this.oscillator.frequency.value))},p5.prototype.Pulse.prototype.start=function(e,o){var i=t.audiocontext.currentTime,n=o||0;if(!this.started){var s=e||this.f,r=this.oscillator.type;this.oscillator=t.audiocontext.createOscillator(),this.oscillator.frequency.setValueAtTime(s,i),this.oscillator.type=r,this.oscillator.connect(this.output),this.oscillator.start(n+i),this.osc2.oscillator=t.audiocontext.createOscillator(),this.osc2.oscillator.frequency.setValueAtTime(s,i),this.osc2.oscillator.type=r,this.osc2.start(n+i),this.freqNode=[this.oscillator.frequency,this.osc2.oscillator.frequency],void 0!==this.mods&&void 0!==this.mods.frequency&&(this.mods.frequency.connect(this.freqNode[0]),this.mods.frequency.connect(this.freqNode[1])),this.started=!0,this.osc2.started=!0}},p5.prototype.Pulse.prototype.stop=function(e){if(this.started){var o=e||0,i=t.audiocontext.currentTime;this.oscillator.stop(o+i),this.osc2.oscillator.stop(o+i),this.started=!1,this.osc2.started=!1}},p5.prototype.Pulse.prototype.freq=function(e,o,i){if("number"==typeof e){this.f=e;var n=t.audiocontext.currentTime,o=o||0,i=i||0,s=this.oscillator.frequency.value;this.oscillator.frequency.cancelScheduledValues(n),this.oscillator.frequency.setValueAtTime(s,n+i),this.oscillator.frequency.exponentialRampToValueAtTime(e,i+o+n),this.osc2.oscillator.frequency.cancelScheduledValues(n),this.osc2.oscillator.frequency.setValueAtTime(s,n+i),this.osc2.oscillator.frequency.exponentialRampToValueAtTime(e,i+o+n),this.freqMod&&(console.log("disconnect freqmod"),this.freqMod.output.disconnect(),this.freqMod=null)}else e.output&&(e.output.disconnect(),e.output.connect(this.oscillator.frequency),e.output.connect(this.osc2.oscillator.frequency),this.freqMod=e,console.log("connect freqmod"))}}(master,oscillator);var noise;noise=function(){"use strict";var t=master;p5.prototype.Noise=function(){this.started=!1,this.buffer=e,this.output=t.audiocontext.createGain(),this.output.gain.value=.5,this.panPosition=0,this.panner=t.audiocontext.createPanner(),this.panner.panningModel="equalpower",this.panner.distanceModel="linear",this.panner.setPosition(0,0,0),this.output.connect(this.panner),this.panner.connect(t.input),t.soundArray.push(this)};var e=function(){for(var e=2*t.audiocontext.sampleRate,o=t.audiocontext.createBuffer(1,e,t.audiocontext.sampleRate),i=o.getChannelData(0),n=0;e>n;n++)i[n]=2*Math.random()-1;return o}(),o=function(){var e,o,i,n,s,r,a,p=2*t.audiocontext.sampleRate,u=t.audiocontext.createBuffer(1,p,t.audiocontext.sampleRate),c=u.getChannelData(0);e=o=i=n=s=r=a=0;for(var l=0;p>l;l++){var h=2*Math.random()-1;e=.99886*e+.0555179*h,o=.99332*o+.0750759*h,i=.969*i+.153852*h,n=.8665*n+.3104856*h,s=.55*s+.5329522*h,r=-.7616*r-.016898*h,c[l]=e+o+i+n+s+r+a+.5362*h,c[l]*=.11,a=.115926*h}return u}(),i=function(){for(var e=2*t.audiocontext.sampleRate,o=t.audiocontext.createBuffer(1,e,t.audiocontext.sampleRate),i=o.getChannelData(0),n=0,s=0;e>s;s++){var r=2*Math.random()-1;i[s]=(n+.02*r)/1.02,n=i[s],i[s]*=3.5}return o}();p5.prototype.Noise.prototype.ampMod=function(e){e.output.gain.cancelScheduledValues(t.audiocontext.currentTime),this.output.connect(e.output.gain)},p5.prototype.Noise.prototype.setType=function(t){switch(t){case"white":this.buffer=e;break;case"pink":this.buffer=o;break;case"brown":this.buffer=i;break;default:this.buffer=e}this.started&&(this.stop(),this.start())},p5.prototype.Noise.prototype.start=function(){this.started&&this.stop(),this.noise=t.audiocontext.createBufferSource(),this.noise.buffer=this.buffer,this.noise.loop=!0,this.noise.connect(this.output),console.log(this.output),this.noise.start(),this.started=!0},p5.prototype.Noise.prototype.stop=function(){this.noise.stop(),this.started=!1},p5.prototype.Noise.prototype.pan=function(t){this.panPosition=t,t=90*t;var e=parseInt(t),o=e+90;o>90&&(o=180-o);var i=Math.sin(e*(Math.PI/180)),n=Math.sin(o*(Math.PI/180));this.panner.setPosition(i,0,n)},p5.prototype.Noise.prototype.amp=function(e,o,i){var o=o||0,i=i||0,n=t.audiocontext.currentTime,s=this.output.gain.value;this.output.gain.cancelScheduledValues(n),this.output.gain.linearRampToValueAtTime(s,n+i+.001),this.output.gain.linearRampToValueAtTime(e,n+i+o+.001)},p5.prototype.Noise.prototype.connect=function(e){this.panner.connect(e?e.hasOwnProperty("input")?e.input:e:t.input)},p5.prototype.Noise.prototype.disconnect=function(){this.output.disconnect(),this.panner.disconnect(),this.output.connect(this.panner)},p5.prototype.Noise.prototype.dispose=function(){this.stop(),this.output.disconnect(),this.panner.disconnect(),this.output=null,this.panner=null,this.buffer=null,this.noise.disconnect(),this.noise=null}}(master);var audioin;audioin=function(){"use strict";var t=master;p5.prototype.AudioIn=function(){t=t,this.input=t.audiocontext.createGain(),this.output=t.audiocontext.createGain(),this.stream=null,this.mediaStream=null,this.currentSource=0,this.amplitude=new p5.prototype.Amplitude,this.output.connect(this.amplitude.input),"undefined"==typeof window.MediaStreamTrack?window.alert("This browser does not support MediaStreamTrack"):"undefined"!=typeof window.MediaStreamTrack.getSources&&window.MediaStreamTrack.getSources(this._gotSources),t.soundArray.push(this)},p5.prototype.AudioIn.prototype.start=function(){var e=this;if(t.inputSources[e.currentSource]){var o=t.inputSources[e.currentSource].id,i={audio:{optional:[{sourceId:o}]}};navigator.getUserMedia(i,this._onStream=function(o){e.stream=o,e.mediaStream=t.audiocontext.createMediaStreamSource(o),e.mediaStream.connect(e.output),e.amplitude.setInput(e.output)},this._onStreamError=function(t){console.error(t)})}else window.navigator.getUserMedia({audio:!0},this._onStream=function(o){e.stream=o,e.mediaStream=t.audiocontext.createMediaStreamSource(o),e.mediaStream.connect(e.output),e.amplitude.setInput(e.output)},this._onStreamError=function(t){console.error(t)})},p5.prototype.AudioIn.prototype.stop=function(){this.stream&&this.stream.stop()},p5.prototype.AudioIn.prototype.connect=function(e){this.output.connect(e?e.hasOwnProperty("input")?e.input:e.hasOwnProperty("analyser")?e.analyser:e:t.input)},p5.prototype.AudioIn.prototype.disconnect=function(t){this.output.disconnect(t),this.output.connect(this.amplitude.input)},p5.prototype.AudioIn.prototype.getLevel=function(t){return t&&(this.amplitude.smoothing=t),this.amplitude.getLevel()},p5.prototype.AudioIn.prototype._gotSources=function(e){for(var o=0;o!==e.length;o++){var i=e[o];"audio"===i.kind&&t.inputSources.push(i)}},p5.prototype.AudioIn.prototype.amp=function(e,o){if(o){var i=o||0,n=this.output.gain.value;this.output.gain.cancelScheduledValues(t.audiocontext.currentTime),this.output.gain.setValueAtTime(n,t.audiocontext.currentTime),this.output.gain.linearRampToValueAtTime(e,i+t.audiocontext.currentTime)}else this.output.gain.cancelScheduledValues(t.audiocontext.currentTime),this.output.gain.setValueAtTime(e,t.audiocontext.currentTime)},p5.prototype.AudioIn.prototype.listSources=function(){return console.log("input sources: "),console.log(t.inputSources),t.inputSources.length>0?t.inputSources:"This browser does not support MediaStreamTrack.getSources()"},p5.prototype.AudioIn.prototype.setSource=function(e){var o=this;t.inputSources.length>0&&e<t.inputSources.length?(o.currentSource=e,console.log("set source to "+t.inputSources[o.currentSource].id)):console.log("unable to set input source")},p5.prototype.AudioIn.prototype.dispose=function(){this.stop(),this.output.disconnect(),this.amplitude.disconnect(),this.amplitude=null,this.output=null}}(master);var env;env=function(){"use strict";var t=master;p5.prototype.Env=function(t,e,o,i,n,s,r){this.attackTime=t,this.attackLevel=e,this.decayTime=o||0,this.sustainTime=n||0,this.sustainLevel=i||0,this.releaseTime=s||0,this.releaseLevel=r||0,this.control=null},p5.prototype.Env.prototype.setInput=function(t){void 0!==t.output&&(t=t.output.gain),this.control=t},p5.prototype.Env.prototype.play=function(e){e||(e=this.control),void 0!==e.output&&(e=e.output.gain),this.control=e;var o=t.audiocontext.currentTime;e.cancelScheduledValues(o),e.setValueAtTime(0,o),e.linearRampToValueAtTime(this.attackLevel,o+this.attackTime),e.linearRampToValueAtTime(this.sustainLevel,o+this.attackTime+this.decayTime),e.setValueAtTime(this.sustainLevel,o+this.attackTime+this.decayTime+this.sustainTime),e.linearRampToValueAtTime(this.releaseLevel,o+this.attackTime+this.decayTime+this.sustainTime+this.releaseTime)},p5.prototype.Env.prototype.triggerAttack=function(e){var o=t.audiocontext.currentTime;e||(e=this.control),void 0!==e.output&&(e=e.output.gain),this.control=e;var i=e.value;e.cancelScheduledValues(o),e.setValueAtTime(i,o),e.linearRampToValueAtTime(this.attackLevel,o+this.attackTime),e.linearRampToValueAtTime(this.attackLevel,o+this.attackTime),e.linearRampToValueAtTime(this.sustainLevel,o+this.attackTime+this.decayTime),e.setValueAtTime(this.sustainLevel,o+this.attackTime+this.decayTime+this.sustainTime)},p5.prototype.Env.prototype.triggerRelease=function(e){var o=t.audiocontext.currentTime;e||(e=this.control),void 0!==e.output&&(e=e.output.gain),void 0!==e.output&&(e=e.output.gain);var i=e.value;e.cancelScheduledValues(t.audiocontext.currentTime),e.setValueAtTime(i,o),e.linearRampToValueAtTime(this.releaseLevel,o+this.releaseTime)}}(master);var src_app;src_app=function(){"use strict";var t=sndcore;return t}(sndcore,master,helpers,soundfile,amplitude,fft,oscillator,pulse,noise,audioin,env);